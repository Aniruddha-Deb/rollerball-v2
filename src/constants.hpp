#pragma once

#include <string>

typedef uint8_t U8;
typedef uint16_t U16;

#define pos(x,y) (((y)<<3)|(x))
#define gety(p)  ((p)>>3)
#define getx(p)  ((p)&0x7)

#define move(p0, p1) (((p0)<<8)|(p1))
#define move_promo(p0, p1, pt) (((p0)<<8)|(p1)|(pt))
#define getp0(m)    (((m)>>8)&0x3f)
#define getpromo(m) ((m)&(PAWN_BISHOP|PAWN_ROOK))
#define getp1(m)    ((m)&0x3f)

#define DEAD 0xff

#define color(p) ((PlayerColor)(p & (WHITE | BLACK)))
#define oppcolor(p) ((PlayerColor)(color(p) ^ (WHITE | BLACK)))
#define occupied(b, p, c) (b[(p)] & (c))
#define inboard(b, x, y) (((x) <= 7) && ((x) >= 0) && ((y) <= 7) && ((y) >= 0) && (b[pos((x),(y))] != 1))

constexpr U8 cw_90_7x7[64] = {
    48, 40, 32, 24, 16, 8,  0,  7,
    49, 41, 33, 25, 17, 9,  1,  15,
    50, 42, 18, 19, 20, 10, 2,  23,
    51, 43, 26, 27, 28, 11, 3,  31,
    52, 44, 34, 35, 36, 12, 4,  39,
    53, 45, 37, 29, 21, 13, 5,  47,
    54, 46, 38, 30, 22, 14, 6,  55,
    56, 57, 58, 59, 60, 61, 62, 63
};

constexpr U8 acw_90_7x7[64] = {
     6, 14, 22, 30, 38, 46, 54, 7,
     5, 13, 21, 29, 37, 45, 53, 15,
     4, 12, 18, 19, 20, 44, 52, 23,
     3, 11, 26, 27, 28, 43, 51, 31,
     2, 10, 34, 35, 36, 42, 50, 39,
     1,  9, 17, 25, 33, 41, 49, 47,
     0,  8, 16, 24, 32, 40, 48, 55,
    56, 57, 58, 59, 60, 61, 62, 63
};

constexpr U8 cw_180_7x7[64] = {
    54, 53, 52, 51, 50, 49, 48, 7,
    46, 45, 44, 43, 42, 41, 40, 15,
    38, 37, 18, 19, 20, 33, 32, 23,
    30, 29, 26, 27, 28, 25, 24, 31,
    22, 21, 34, 35, 36, 17, 16, 39,
    14, 13, 12, 11, 10,  9,  8, 47,
     6,  5,  4,  3,  2,  1,  0, 55,
    56, 57, 58, 59, 60, 61, 62, 63
};

constexpr U8 id_7x7[64] = {
     0,  1,  2,  3,  4,  5,  6,  7,
     8,  9, 10, 11, 12, 13, 14, 15,
    16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, 28, 29, 30, 31,
    32, 33, 34, 35, 36, 37, 38, 39,
    40, 41, 42, 43, 44, 45, 46, 47,
    48, 49, 50, 51, 52, 53, 54, 55,
    56, 57, 58, 59, 60, 61, 62, 63
};

constexpr U8 cw_90_8x8[64] = {
    56, 48, 40, 32, 24, 16, 8,  0,
    57, 49, 41, 33, 25, 17, 9,  1,
    58, 50, 42, 34, 26, 18, 10, 2,
    59, 51, 43, 35, 27, 19, 11, 3,
    60, 52, 44, 36, 28, 20, 12, 4,
    61, 53, 45, 37, 29, 21, 13, 5,
    62, 54, 46, 38, 30, 22, 14, 6,
    63, 55, 47, 39, 31, 23, 15, 7
};

constexpr U8 acw_90_8x8[64] = {
    7, 15, 23, 31, 39, 47, 55, 63,
    6, 14, 22, 30, 38, 46, 54, 62,
    5, 13, 21, 29, 37, 45, 53, 61,
    4, 12, 20, 28, 36, 44, 52, 60,
    3, 11, 19, 27, 35, 43, 51, 59,
    2, 10, 18, 26, 34, 42, 50, 58,
    1, 9,  17, 25, 33, 41, 49, 57,
    0, 8,  16, 24, 32, 40, 48, 56
};

constexpr U8 cw_180_8x8[64] = {
    63, 62, 61, 60, 59, 58, 57, 56,
    55, 54, 53, 52, 51, 50, 49, 48,
    47, 46, 45, 44, 43, 42, 41, 40,
    39, 38, 37, 36, 35, 34, 33, 32,
    31, 30, 29, 28, 27, 26, 25, 24,
    23, 22, 21, 20, 19, 18, 17, 16,
    15, 14, 13, 12, 11, 10, 9,  8,
    7,  6,  5,  4,  3,  2,  1,  0
};

constexpr U8 id_8x8[64] = {
     0,  1,  2,  3,  4,  5,  6,  7,
     8,  9, 10, 11, 12, 13, 14, 15,
    16, 17, 18, 19, 20, 21, 22, 23,
    24, 25, 26, 27, 28, 29, 30, 31,
    32, 33, 34, 35, 36, 37, 38, 39,
    40, 41, 42, 43, 44, 45, 46, 47,
    48, 49, 50, 51, 52, 53, 54, 55,
    56, 57, 58, 59, 60, 61, 62, 63
};

constexpr U8 board_7_3[64] = {
    3, 2, 2, 2, 2, 2, 2, 1,
    3, 3, 2, 2, 2, 2, 5, 1,
    3, 3, 1, 1, 1, 5, 5, 1,
    3, 3, 1, 1, 1, 5, 5, 1,
    3, 3, 1, 1, 1, 5, 5, 1,
    3, 4, 4, 4, 4, 5, 5, 1,
    4, 4, 4, 4, 4, 4, 5, 1,
    1, 1, 1, 1, 1, 1, 1, 1
};

constexpr U8 board_8_2[64] = {
    3, 2, 2, 2, 2, 2, 2, 2,
    3, 3, 2, 2, 2, 2, 2, 5,
    3, 3, 3, 2, 2, 2, 5, 5,
    3, 3, 3, 1, 1, 5, 5, 5,
    3, 3, 3, 1, 1, 5, 5, 5,
    3, 3, 4, 4, 4, 5, 5, 5,
    3, 4, 4, 4, 4, 4, 5, 5,
    4, 4, 4, 4, 4, 4, 4, 5
};

constexpr U8 board_8_4[64] = {
    3, 2, 2, 2, 2, 2, 2, 2,
    3, 3, 2, 2, 2, 2, 2, 5,
    3, 3, 1, 1, 1, 1, 5, 5,
    3, 3, 1, 1, 1, 1, 5, 5,
    3, 3, 1, 1, 1, 1, 5, 5,
    3, 3, 1, 1, 1, 1, 5, 5,
    3, 4, 4, 4, 4, 4, 5, 5,
    4, 4, 4, 4, 4, 4, 4, 5
};

// Let's not do this now. Loading / storing from a string config will become too 
// complex
// const char* board_7_3_startconfig = R"BOARD(
//         
// ..rbp.. 
// ..rkp.. 
// ..   .. 
// ..   .. 
// ..   .. 
// ..PKR.. 
// ..PBR.. 
// )BOARD";
// 
// const char* board_8_4_startconfig = R"BOARD(
// ..rnbp..        
// ..rnkp..
// ..    ..
// ..    ..
// ..    ..
// ..    ..
// ..PKNR..
// ..PBNR..
// )BOARD";
// 
// // TODO
// const char* board_8_2_startconfig = R"BOARD(
// ........        
// ........
// ........
// ...  ...
// ...  ...
// ........
// ........
// ........
// )BOARD";
